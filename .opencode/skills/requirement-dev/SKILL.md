---
name: requirement-dev
description: 需求开发工作流，对用户输入的需求进行拆分细化，确认后生成详细设计文档
license: MIT
compatibility: opencode
---

# requirement-dev

需求开发工作流，对用户输入的需求进行拆分细化，确认后生成详细设计文档。

## 前置条件

- 用户能够清晰描述需求内容
- 项目有 docs 目录用于存放设计文档

## 执行步骤

### 1. 收集原始需求

首先向用户询问需求内容：

```
请描述您需要开发的功能或需求：
- 功能目标是什么？
- 目标用户是谁？
- 期望的交互方式？
- 是否有特殊的技术要求？
```

### 2. 需求拆分与细化

将需求拆分为以下维度进行分析：

**功能维度**：
- 核心功能列表
- 辅助功能列表
- 边界条件处理

**数据维度**：
- 需要存储的数据
- 数据来源
- 数据流转

**交互维度**：
- 用户操作流程
- 界面展示要求
- 反馈机制

**技术维度**：
- 实现方式选择
- 依赖关系
- 性能要求

### 3. 展示拆分结果供用户确认

向用户展示拆分的详细内容，使用选项确认格式：

```
请确认以下需求拆分：

## 功能范围
- [ ] 功能点1（已确认）
- [ ] 功能点2（待确认）
- [ ] 功能点3（待确认）

## 技术方案
- [ ] 方案A（推荐）
- [ ] 方案B（备选）

是否需要修改或补充？请选择：
1. 全部确认
2. 修改某一项
3. 补充新内容
4. 重新输入需求
```

### 4. 收集用户反馈

根据用户选择，执行相应操作：

**选项 1 - 全部确认**：进入文档生成阶段
**选项 2 - 修改某一项**：让用户指定修改项，重新分析
**选项 3 - 补充新内容**：让用户输入补充内容，更新需求分析
**选项 4 - 重新输入**：重新开始需求收集

### 5. 生成设计文档

在 `docs/design/` 目录下生成设计文档：

**文件名格式**：`{时间戳}-{功能说明}.md`

时间戳格式：`YYYYMMDD-HHMMSS`
示例：`20260210-143000-用户登录功能.md`

**文档模板结构**：

```markdown
# 功能名称

## 1. 需求概述

### 1.1 背景说明
需求产生的背景和原因

### 1.2 目标用户
目标用户群体描述

### 1.3 核心目标
需求要解决的核心问题

## 2. 功能描述

### 2.1 功能列表
| 功能模块 | 功能描述 | 优先级 |
|---------|---------|--------|
| 功能1 | 描述 | P0 |
| 功能2 | 描述 | P1 |

### 2.2 功能详情
每个功能的详细描述，包括：
- 功能入口
- 操作步骤
- 预期结果
- 异常处理

## 3. 数据设计

### 3.1 数据模型
```go
// 或 TypeScript 类型定义
type Feature struct {
    ID      uint   `json:"id" gorm:"primaryKey"`
    Name    string `json:"name"`
    // ...
}
```

### 3.2 数据流转
描述数据在各模块间的流转关系

## 4. API 设计

### 4.1 接口列表
| 方法 | 路径 | 描述 |
|-----|------|-----|
| GET | /api/xxx | 获取列表 |
| POST | /api/xxx | 创建 |

### 4.2 请求参数
```json
{
    "param1": "description",
    "param2": "description"
}
```

### 4.3 响应格式
```json
{
    "code": 200,
    "data": {},
    "message": "success"
}
```

## 5. 前端设计

### 5.1 页面结构
描述涉及的页面和组件

### 5.2 交互流程
用户操作流程图或步骤描述

### 5.3 状态管理
需要存储的状态和状态管理方案

## 6. 技术实现

### 6.1 实现方案
技术选型和实现思路

### 6.2 依赖关系
需要引入的依赖或服务

### 6.3 性能要求
响应时间、并发量等性能指标

## 7. 测试要点

### 7.1 测试场景
需要覆盖的测试场景

### 7.2 边界条件
特殊边界情况处理

## 8. 风险评估

### 8.1 技术风险
可能存在的技术风险

### 8.2 业务风险
业务层面的风险点

## 9. 里程碑

- [ ] 阶段1：完成时间点
- [ ] 阶段2：完成时间点

## 10. 备注
其他需要说明的内容
```

### 6. 文档生成确认

文档生成后，向用户确认：

```
设计文档已生成：`docs/design/{时间戳}-{功能说明}.md`

是否需要：
1. 直接开始开发
2. 修改文档内容
3. 创建待办事项列表
```

## 使用示例

### 示例对话

**Assistant**: 请描述您需要开发的功能或需求？

**User**: 我想添加一个用户头像上传功能

**Assistant**: 
## 需求分析

**原始需求**：用户头像上传功能

### 初步拆分：

**功能范围**：
- [ ] 头像上传（支持拖拽和点击选择）
- [ ] 头像裁剪（上传后自动裁剪为正方形）
- [ ] 头像预览（上传前预览效果）
- [ ] 头像删除（移除当前头像）

**技术方案**：
- [ ] 前端裁剪（使用 canvas 裁剪）
- [ ] 后端裁剪（服务端处理）
- [ ] 云服务处理（上传到云端裁剪）

**支持的格式**：
- [ ] JPG
- [ ] PNG
- [ ] WebP

**文件大小限制**：
- [ ] 2MB
- [ ] 5MB
- [ ] 自定义：___ MB

请选择确认方式：
1. 全部确认
2. 修改某一项
3. 补充新内容
4. 重新输入需求

**User**: 选择 1，全部确认

**Assistant**: 
正在生成设计文档...

设计文档已生成：`docs/design/20260210-143000-用户头像上传功能.md`

是否需要：
1. 直接开始开发
2. 修改文档内容
3. 创建待办事项列表

## 注意事项

- 需求描述越详细，生成的文档越完整
- 优先确认核心功能（P0），辅助功能可后续补充
- 确认过程中可以随时修改或补充内容
- 生成的文档可直接作为开发参考
- 建议在开发前与产品/设计确认需求细节
